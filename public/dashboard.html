<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VHP CTF Dashboard</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Source+Code+Pro:wght@400;600&display=swap');

body {
    background: #0a0a0a;
    font-family: 'Source Code Pro', monospace;
    color: #00ff00;
    margin: 0;
    padding: 0;
    min-height: 100vh;
}

/* Cyber glow background */
body::before {
    content: '';
    position: fixed;
    top:0; left:0;
    width:100%; height:100%;
    background:
        radial-gradient(circle at 20% 50%, rgba(0, 255, 255, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(0, 255, 0, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 40% 80%, rgba(0, 128, 255, 0.1) 0%, transparent 50%);
    animation: backgroundPulse 8s ease-in-out infinite alternate;
    z-index:-1;
}
@keyframes backgroundPulse { 0% { opacity:0.3; } 100% { opacity:0.7; } }

/* Header */
header {
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:1rem 2rem;
}
header h2 {
    font-family:'Orbitron', monospace;
    color:#00ffff;
    text-shadow:0 0 10px #00ffff;
}

/* Buttons */
.btn {
    border:2px solid #00ff00;
    background:linear-gradient(45deg,#001100,#003300);
    color:#00ff00;
    padding:0.5rem 1rem;
    border-radius:8px;
    cursor:pointer;
    transition:0.3s;
    font-size:0.9rem;
    margin-right:10px;
}
.btn:hover {
    background:linear-gradient(45deg,#002200,#004400);
    color:#00ffff;
    box-shadow:0 0 15px #00ff00;
}

/* Profile menu */
.profile {
    position:relative;
    display:inline-block;
}
.profile-btn {
    font-size:1.8rem;
    cursor:pointer;
}
.profile-menu {
    display:none;
    position:absolute;
    right:0;
    background:#111;
    border:1px solid #00ff00;
    border-radius:8px;
    min-width:150px;
    box-shadow:0 0 15px rgba(0,255,0,0.5);
    z-index:10;
}
.profile-menu a {
    display:block;
    padding:0.8rem;
    text-decoration:none;
    color:#00ff00;
    transition:0.3s;
}
.profile-menu a:hover {
    background:#002200;
    color:#00ffff;
}
.profile.open .profile-menu { display:block; }

/* User info */
.user-info {
    text-align:center;
    margin:1rem;
    font-size:1.2rem;
}

/* Quote section */
.quote-box {
    max-width:800px;
    margin:2rem auto;
    padding:2rem;
    border:1px solid #00ff00;
    border-radius:12px;
    background:rgba(0,0,0,0.7);
    text-align:center;
    box-shadow:0 0 20px rgba(0,255,0,0.3);
}
.quote-box h2 {
    color:#00ffff;
    margin-bottom:1rem;
}
.quote-box p {
    font-size:1.2rem;
    line-height:1.6;
    color:#00ff99;
}
</style>
</head>
<body>

<header>
    <div>
        <button class="btn" onclick="window.location.href='leaderboard.html'">üèÜ Leaderboard</button>
        <button class="btn" onclick="window.location.href='challenges.html'">‚ö° Challenges</button>
    </div>
    <h2>VHP CTF Dashboard</h2>
    <div class="profile" id="profile">
        <div class="profile-btn">üë®‚Äçüíª</div>
        <div class="profile-menu">
            <a href="#" id="profile-info">Profile</a>
            <a href="index.html" onclick="logout()">Logout</a>
        </div>
    </div>
</header>

<div class="user-info" id="user-info">Loading user info...</div>

<!-- Quote Section -->
<div class="quote-box">
    <h2>üí° Hacker's Wisdom</h2>
    <p>"In every challenge lies a flag, waiting for those who dare to think differently."</p>
</div>

<script>
// Toggle profile dropdown
document.getElementById("profile").addEventListener("click", () => {
    document.getElementById("profile").classList.toggle("open");
});

// Fetch logged in user
fetch("/api/user")
  .then(res => res.json())
  .then(data => {
      if(!data.success || !data.user){
          window.location.href = "/index.html"; // not logged in
      } else {
          const user = data.user;  // <-- get the actual user object
          document.getElementById("user-info").innerHTML =
              `üë§ Logged in as: <strong>${user.username}</strong> | Score: ${user.score}`;
          document.getElementById("profile-info").innerText = user.username;
      }
  });


// Logout
function logout(){
    fetch("/api/logout",{method:"POST"}).then(()=>window.location.href="/login.html");
}
</script>

</body>
</html>
