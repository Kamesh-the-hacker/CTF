<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VHP CTF Register</title>
<style>
body { background:#0a0a0a; font-family:'Source Code Pro', monospace; color:#00ff00; display:flex; justify-content:center; align-items:center; min-height:100vh; }
.form-container {background:rgba(0,0,0,0.8); border:1px solid #00ff00; border-radius:10px; padding:2rem; width:350px; box-shadow:0 0 20px rgba(0,255,0,0.5);}
h2{text-align:center; color:#00ffff; margin-bottom:2rem;}
label{display:block;margin-bottom:0.5rem;}
input[type="text"], input[type="password"]{width:100%; padding:0.8rem; border-radius:5px; border:1px solid #00ff00; background:#001100; color:#00ff00;}
.btn{width:100%; padding:0.8rem; background: linear-gradient(45deg, #001100, #003300); color:#00ff00; border:2px solid #00ff00; border-radius:8px; cursor:pointer;}
.message{text-align:center; padding:0.8rem; margin-bottom:1rem; border-radius:5px;}
.message.error {background: rgba(255,0,64,0.1); border:1px solid #ff0040; color:#ff0040;}
.message.success {background: rgba(0,255,0,0.1); border:1px solid #00ff00; color:#00ff00;}
</style>
</head>
<body>
<div class="form-container">
<h2>Register for VHP CTF</h2>
<div id="message"></div>
<form id="register-form">
    <label>Username:</label>
    <input type="text" id="username" required>
    <label>Password:</label>
    <input type="password" id="password" required>
    <label>Confirm Password:</label>
    <input type="password" id="confirm-password" required>
    <button type="submit" class="btn">Register</button>
</form>
<p style="text-align:center; margin-top:1rem;">
Already have an account? <a href="login.html" style="color:#00ffff;">Login here</a>
</p>
</div>

<script>
const form = document.getElementById('register-form');
const messageDiv = document.getElementById('message');

form.addEventListener('submit', async e => {
    e.preventDefault();
    const username = document.getElementById('username').value.trim();
    const password = document.getElementById('password').value;
    const confirmPassword = document.getElementById('confirm-password').value;

    if(password !== confirmPassword){
        messageDiv.innerHTML = '<div class="message error">Passwords do not match</div>';
        return;
    }

    try {
        const res = await fetch('/api/register', {
            method:'POST',
            headers:{'Content-Type':'application/json'},
            body:JSON.stringify({username, password})
        });
        const data = await res.json();
        if(data.success){
            messageDiv.innerHTML = '<div class="message success">Registration Successful! Redirecting...</div>';
            setTimeout(()=>{ window.location.href='login.html'; },1500);
        } else {
            messageDiv.innerHTML = `<div class="message error">${data.message}</div>`;
        }
    } catch(err){
        messageDiv.innerHTML = '<div class="message error">Server error. Try again later.</div>';
        console.error(err);
    }
});
</script>
</body>
</html>
